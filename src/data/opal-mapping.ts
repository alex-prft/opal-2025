// OPAL mapping data structure - shared across components
export const opalMapping = {
  "Strategy Plans": {
    "OSA": {
      "navigation_structure": {
        "tier1": "Strategy Plans",
        "tier2": "OSA",
        "tier3": [
          "Overview Dashboard",
          "Strategic Recommendations",
          "Performance Metrics",
          "Data Quality Score",
          "Workflow Timeline"
        ]
      }
    },
    "Quick Wins": {
      "navigation_structure": {
        "tier1": "Strategy Plans",
        "tier2": "Quick Wins",
        "tier3": [
          "Immediate Opportunities",
          "Implementation Roadmap (30-day)",
          "Resource Requirements",
          "Expected Impact",
          "Success Metrics"
        ]
      }
    },
    "Maturity": {
      "navigation_structure": {
        "tier1": "Strategy Plans",
        "tier2": "Maturity",
        "tier3": [
          "Current State Assessment",
          "Maturity Framework",
          "Gap Analysis",
          "Improvement Pathway",
          "Benchmarking Data"
        ]
      }
    },
    "Phases": {
      "navigation_structure": {
        "tier1": "Strategy Plans",
        "tier2": "Phases",
        "tier3": [
          "Phase 1: Foundation (0-3 months)",
          "Phase 2: Growth (3-6 months)",
          "Phase 3: Optimization (6-12 months)",
          "Phase 4: Innovation (12+ months)",
          "Cross-phase Dependencies"
        ]
      }
    },
    "Roadmap": {
      "navigation_structure": {
        "tier1": "Strategy Plans",
        "tier2": "Roadmap",
        "tier3": [
          "Timeline View",
          "Milestone Tracking",
          "Resource Allocation",
          "Risk Assessment",
          "Progress Indicators"
        ]
      }
    }
  },
  "Optimizely DXP Tools": {
    "Content Recs": {
      "navigation_structure": {
        "tier1": "Optimizely DXP Tools",
        "tier2": "Content Recs",
        "tier3": [
          "Visitor Analytics Dashboard",
          "Content Performance Metrics",
          "Recommendation Algorithms",
          "A/B Testing Results",
          "Personalization Effectiveness"
        ]
      }
    },
    "CMS": {
      "navigation_structure": {
        "tier1": "Optimizely DXP Tools",
        "tier2": "CMS",
        "tier3": [
          "Content Inventory",
          "Publishing Workflows",
          "Content Performance",
          "SEO Optimization",
          "Multi-channel Publishing"
        ]
      }
    },
    "ODP": {
      "navigation_structure": {
        "tier1": "Optimizely DXP Tools",
        "tier2": "ODP",
        "tier3": [
          "Customer Profiles",
          "Audience Segments",
          "Journey Analytics",
          "Real-time Events",
          "Data Integration Status"
        ]
      }
    },
    "WEBX": {
      "navigation_structure": {
        "tier1": "Optimizely DXP Tools",
        "tier2": "WEBX",
        "tier3": [
          "Active Experiments",
          "Results Analysis",
          "Statistical Significance",
          "Conversion Impact",
          "Test Configuration"
        ]
      }
    },
    "CMP": {
      "navigation_structure": {
        "tier1": "Optimizely DXP Tools",
        "tier2": "CMP",
        "tier3": [
          "Campaign Performance",
          "Email Analytics",
          "Automation Workflows",
          "Audience Targeting",
          "ROI Analysis"
        ]
      }
    }
  },
  "Analytics Insights": {
    "OSA": {
      "navigation_structure": {
        "tier1": "Analytics Insights",
        "tier2": "OSA",
        "tier3": [
          "Engagement",
          "Topics",
          "Popular",
          "AI Visibility",
          "Semantic",
          "Geographic",
          "Freshness"
        ]
      }
    },
    "Content": {
      "navigation_structure": {
        "tier1": "Analytics Insights",
        "tier2": "Content",
        "tier3": [
          "Engagement",
          "Topics",
          "Popular",
          "AI Visibility",
          "Semantic",
          "Geographic",
          "Freshness"
        ]
      }
    },
    "Audiences": {
      "navigation_structure": {
        "tier1": "Analytics Insights",
        "tier2": "Audiences",
        "tier3": [
          "Engagement",
          "Topics",
          "Popular",
          "AI Visibility",
          "Semantic",
          "Geographic",
          "Freshness"
        ]
      }
    },
    "CX": {
      "navigation_structure": {
        "tier1": "Analytics Insights",
        "tier2": "CX",
        "tier3": [
          "Engagement",
          "Topics",
          "Popular",
          "AI Visibility",
          "Semantic",
          "Geographic",
          "Freshness"
        ]
      }
    },
    "Experimentation": {
      "navigation_structure": {
        "tier1": "Analytics Insights",
        "tier2": "Experimentation",
        "tier3": [
          "Engagement",
          "Topics",
          "Popular",
          "AI Visibility",
          "Semantic",
          "Geographic",
          "Freshness"
        ]
      }
    },
    "Personalization": {
      "navigation_structure": {
        "tier1": "Analytics Insights",
        "tier2": "Personalization",
        "tier3": [
          "Engagement",
          "Topics",
          "Popular",
          "AI Visibility",
          "Semantic",
          "Geographic",
          "Freshness"
        ]
      }
    },
    "Trends": {
      "navigation_structure": {
        "tier1": "Analytics Insights",
        "tier2": "Trends",
        "tier3": [
          "Engagement",
          "Topics",
          "Popular",
          "AI Visibility",
          "Semantic",
          "Geographic",
          "Freshness"
        ]
      }
    }
  },
  "Experience Optimization": {
    "Content": {
      "navigation_structure": {
        "tier1": "Experience Optimization",
        "tier2": "Content",
        "tier3": [
          "Content Strategy Overview",
          "AI for SEO",
          "Performance Analytics",
          "Content Optimization Recommendations",
          "Multi-channel Content Distribution",
          "Content ROI Analysis"
        ]
      }
    },
    "Experimentation": {
      "navigation_structure": {
        "tier1": "Experience Optimization",
        "tier2": "Experimentation",
        "tier3": [
          "Experiment Design Framework",
          "Statistical Testing Results",
          "Hypothesis Validation",
          "Test Impact Assessment",
          "Experimentation Roadmap"
        ]
      }
    },
    "Personalization": {
      "navigation_structure": {
        "tier1": "Experience Optimization",
        "tier2": "Personalization",
        "tier3": [
          "Personalization Strategy",
          "Audience Segmentation",
          "Dynamic Content Delivery",
          "Personalization Performance",
          "Real-time Optimization"
        ]
      }
    },
    "UX": {
      "navigation_structure": {
        "tier1": "Experience Optimization",
        "tier2": "UX",
        "tier3": [
          "User Journey Mapping",
          "Interaction Analytics",
          "Usability Testing Results",
          "Conversion Path Optimization",
          "Experience Quality Metrics"
        ]
      }
    },
    "Technology": {
      "navigation_structure": {
        "tier1": "Experience Optimization",
        "tier2": "Technology",
        "tier3": [
          "Integration Architecture",
          "Platform Performance",
          "API Analytics",
          "Data Flow Optimization",
          "Technical Implementation Guide"
        ]
      }
    }
  }
} as const;

// Helper function to get mapping data for a specific tier1 section
export function getMappingForTier1(tier1Name: string) {
  return Object.values(opalMapping).find(
    section => {
      const firstSubSection = Object.values(section)[0] as any;
      return firstSubSection?.navigation_structure?.tier1 === tier1Name;
    }
  );
}

// Helper function to get all tier2 sections for a tier1
export function getTier2ItemsForTier1(tier1Name: string) {
  const tier1Section = getMappingForTier1(tier1Name);
  return tier1Section ? Object.keys(tier1Section) : [];
}

// Helper function to get tier3 items for a specific tier2 section
export function getTier3ItemsForTier2(tier1Name: string, tier2Name: string) {
  const tier1Section = getMappingForTier1(tier1Name);
  if (!tier1Section) return [];

  const tier2Section = tier1Section[tier2Name as keyof typeof tier1Section] as any;
  return tier2Section?.navigation_structure?.tier3 || [];
}

// Convert URL segment to proper tier1 name by finding exact match in mapping
export function urlToTier1Name(tier1Url: string): string {
  // Get all tier1 keys from the mapping
  const tier1Keys = Object.keys(opalMapping);

  // Find exact match (case-insensitive)
  const exactMatch = tier1Keys.find(key =>
    key.toLowerCase() === tier1Url.toLowerCase()
  );

  if (exactMatch) return exactMatch;

  // Find match by converting URL format back
  const convertedName = tier1Url.split('-').map(word =>
    word.charAt(0).toUpperCase() + word.slice(1)
  ).join(' ');

  const convertedMatch = tier1Keys.find(key =>
    key.toLowerCase() === convertedName.toLowerCase()
  );

  return convertedMatch || convertedName;
}

// Convert URL segment to proper tier2 name by finding exact match in mapping
export function urlToTier2Name(tier1Name: string, tier2Url: string): string {
  const tier1Section = getMappingForTier1(tier1Name);
  if (!tier1Section) return tier2Url;

  // Get all tier2 keys for this tier1
  const tier2Keys = Object.keys(tier1Section);

  // Find exact match (case-insensitive)
  const exactMatch = tier2Keys.find(key =>
    key.toLowerCase() === tier2Url.toLowerCase()
  );

  if (exactMatch) return exactMatch;

  // Find match by converting URL format back
  const convertedName = tier2Url.split('-').map(word =>
    word.charAt(0).toUpperCase() + word.slice(1)
  ).join(' ');

  const convertedMatch = tier2Keys.find(key =>
    key.toLowerCase() === convertedName.toLowerCase()
  );

  return convertedMatch || convertedName;
}